<head>
{{response.files.append("http://ajax.googleapis.com/ajax/libs/jqueryui/1.3.2/jquery.min.js")}} 
{{response.files.append("http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/jquery-ui.js")}}
{{response.files.append("http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/themes/base/jquery-ui.css")}}
<!--{{response.files.append(URL(request.application,'css','base.css', args=['1']))}}  , _style="left:%(x)sem;top:%(y)sem;width:%(w)sem;height:%(h)sem;" % dict(x=tbox.position_x,y=tbox.position_y,w=tbox.width,h=tbox.height)


            
            
            -->
{{include 'web2py_ajax.html'}}
<script>
$(document).ready(function(){
    var pxPerem = $("div.page").width()/70.0
    $(".txtbox").disableSelection();
    $(".txtbox").draggable({
        snap: ".snapable",
        snapTolerance: 5,
        stop: function(event, ui) {
            jQuery.post('{{=URL("call/run/move")}}', { id:$(this).attr("id").replace('tb',''), x:($(this).offset().left - $("div.page").offset().left)/pxPerem, y:($(this).offset().top - $("div.page").offset().top)/pxPerem }, function(data){ $("div#error").text("Something happened"); });
        }
    });
    $(".txtbox").resizable();  
});
</script>
<link rel="stylesheet" type="text/css" href={{=URL('css','base.css', vars=dict(id=page.id))}} />
</head>
<body class="page">
    <div id="main_page" class="page snapable">
    {{for tbox in boxes:}}
        {{=DIV(tbox.body, _id="tb%s"%tbox.id, _class="txtbox snapable")}}
    {{pass}}
    </div>
        
    <div id="error">No error yet.</div>
 <!--   <div id="start">Waiting for dragging the image get started...</div> -->
    <div id="stop">Waiting image getting dropped...</div>
    
    {{=form}}
</body>
